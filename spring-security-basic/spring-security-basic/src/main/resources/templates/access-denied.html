<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle}">Access Denied - Spring Security Demo</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        body {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            min-height: 100vh;
        }
        .access-denied-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
        }
        .access-denied-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        .error-icon {
            font-size: 6rem;
            color: #dc3545;
        }
        .btn-back {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
        }
        .role-info {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <div class="access-denied-container">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8 col-lg-6">
                    <!-- Access Denied Card -->
                    <div class="access-denied-card p-5 text-center">
                        <!-- Error Icon -->
                        <div class="error-icon mb-4">
                            <i class="bi bi-shield-exclamation"></i>
                        </div>
                        
                        <!-- Error Title -->
                        <h1 class="display-6 fw-bold text-danger mb-3">
                            Access Denied
                        </h1>
                        
                        <!-- Error Message -->
                        <p class="lead text-muted mb-4">
                            <span th:text="${errorMessage}">
                                You don't have permission to access this resource.
                            </span>
                        </p>
                        
                        <!-- User Information (if authenticated) -->
                        <div sec:authorize="isAuthenticated()" class="role-info">
                            <h6 class="mb-2">
                                <i class="bi bi-person-badge"></i> Current User Information
                            </h6>
                            <p class="mb-1">
                                <strong>Username:</strong> 
                                <span sec:authentication="name">Username</span>
                            </p>
                            <p class="mb-0">
                                <strong>Your Roles:</strong>
                                <span sec:authentication="authorities" class="badge bg-secondary ms-1"></span>
                            </p>
                        </div>
                        
                        <!-- Help Information -->
                        <div class="alert alert-info" role="alert">
                            <i class="bi bi-info-circle"></i>
                            <strong>Need different access?</strong><br>
                            This resource requires specific roles. Please contact your administrator 
                            or try logging in with a different account that has the required permissions.
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                            <a th:href="@{/}" class="btn btn-primary btn-back me-md-2">
                                <i class="bi bi-house"></i> Go Home
                            </a>
                            <a th:href="@{/dashboard}" class="btn btn-outline-secondary" sec:authorize="isAuthenticated()">
                                <i class="bi bi-speedometer2"></i> Dashboard
                            </a>
                            <a th:href="@{/login}" class="btn btn-outline-secondary" sec:authorize="!isAuthenticated()">
                                <i class="bi bi-box-arrow-in-right"></i> Login
                            </a>
                        </div>
                        
                        <!-- Additional Actions for Authenticated Users -->
                        <div sec:authorize="isAuthenticated()" class="mt-4">
                            <hr>
                            <h6 class="mb-3">Available Areas for Your Role:</h6>
                            <div class="d-flex flex-wrap gap-2 justify-content-center">
                                <!-- User Area -->
                                <div sec:authorize="hasRole('USER')">
                                    <a th:href="@{/user}" class="btn btn-sm btn-outline-primary">
                                        <i class="bi bi-person"></i> User Area
                                    </a>
                                </div>
                                
                                <!-- Management Area -->
                                <div sec:authorize="hasAnyRole('MANAGER', 'ADMIN')">
                                    <a th:href="@{/management}" class="btn btn-sm btn-outline-warning">
                                        <i class="bi bi-gear"></i> Management
                                    </a>
                                </div>
                                
                                <!-- Admin Area -->
                                <div sec:authorize="hasRole('ADMIN')">
                                    <a th:href="@{/admin}" class="btn btn-sm btn-outline-danger">
                                        <i class="bi bi-shield-exclamation"></i> Admin Panel
                                    </a>
                                </div>
                            </div>
                            
                            <!-- Logout Option -->
                            <div class="mt-3">
                                <form th:action="@{/logout}" method="post" class="d-inline">
                                    <button type="submit" class="btn btn-sm btn-outline-secondary">
                                        <i class="bi bi-box-arrow-right"></i> Logout
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Information -->
    <footer class="position-fixed bottom-0 w-100 bg-dark text-white py-2">
        <div class="container">
            <div class="text-center">
                <small>
                    <i class="bi bi-shield-lock"></i> 
                    Spring Security Demo - Error Code: 403 Forbidden
                </small>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Add some animation to the error icon
        document.addEventListener('DOMContentLoaded', function() {
            const errorIcon = document.querySelector('.error-icon');
            if (errorIcon) {
                // Pulse animation
                setInterval(() => {
                    errorIcon.style.transform = 'scale(1.1)';
                    setTimeout(() => {
                        errorIcon.style.transform = 'scale(1)';
                    }, 500);
                }, 3000);
            }
        });
        
        // Show a helpful tip after 5 seconds
        setTimeout(() => {
            const tip = document.createElement('div');
            tip.className = 'alert alert-light mt-3';
            tip.innerHTML = '<i class="bi bi-lightbulb"></i> <strong>Tip:</strong> Try the demo accounts from the login page to explore different access levels!';
            
            const card = document.querySelector('.access-denied-card');
            if (card) {
                card.appendChild(tip);
            }
        }, 5000);
    </script>
</body>
</html>